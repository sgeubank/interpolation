(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14850,        360]
NotebookOptionsPosition[     13526,        332]
NotebookOutlinePosition[     13881,        348]
CellTagsIndexPosition[     13838,        345]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"n", " ", "=", " ", "3"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"1", " ", "+", " ", 
   RowBox[{"3", "x"}], " ", "+", " ", 
   RowBox[{"x", "^", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"d", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "/", "n"}], ",", 
      RowBox[{"fun", "[", 
       RowBox[{"k", "/", "n"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"d2", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"[", 
      RowBox[{"k", ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "[", "d", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7495460301056337`*^9, 3.749546150552847*^9}, {
   3.749546198972649*^9, 3.749546291126536*^9}, {3.749546372674322*^9, 
   3.74954643019832*^9}, {3.7495464794874153`*^9, 3.749546632030587*^9}, {
   3.749547125875698*^9, 3.749547149668849*^9}, {3.749547187292811*^9, 
   3.749547196402919*^9}, {3.74954722773913*^9, 3.749547241670442*^9}, {
   3.749547276055147*^9, 3.749547283226609*^9}, {3.749547758123528*^9, 
   3.749547766222251*^9}, {3.7495478098294*^9, 3.7495478188100147`*^9}, {
   3.749547956352969*^9, 3.749547956595916*^9}, {3.749547988196661*^9, 
   3.74954798834551*^9}, {3.7495480185581007`*^9, 3.749548042576635*^9}, {
   3.749548096767167*^9, 3.749548112824801*^9}, {3.749548148839486*^9, 
   3.7495482344396067`*^9}, {3.7495482954910297`*^9, 
   3.7495482956675787`*^9}, {3.7495483273692417`*^9, 3.749548338189639*^9}, {
   3.749548439495672*^9, 3.74954844563697*^9}, {3.749548530760906*^9, 
   3.749548567647277*^9}, {3.7495486357241163`*^9, 3.749548654373951*^9}, {
   3.7495487533697968`*^9, 3.749548753636612*^9}, {3.74954882314541*^9, 
   3.749548823531825*^9}, {3.749548879463665*^9, 3.7495489351694307`*^9}, {
   3.749549016471795*^9, 3.749549052960651*^9}, {3.749549180376073*^9, 
   3.749549265793456*^9}, {3.749549304654625*^9, 3.749549327153192*^9}, {
   3.74954938974116*^9, 3.7495494126333*^9}, {3.749549520504283*^9, 
   3.749549563248365*^9}, {3.749549621107256*^9, 3.749549732769825*^9}, 
   3.7495497651501083`*^9, {3.7495497987608023`*^9, 3.749549814983445*^9}, 
   3.749549879588828*^9, {3.749549931882571*^9, 3.74954993728053*^9}, {
   3.749550431109963*^9, 3.749550431256282*^9}, {3.7495506225093927`*^9, 
   3.74955062272073*^9}, {3.74955164150066*^9, 3.749551641620564*^9}, 
   3.749551840472889*^9},
 CellLabel->
  "In[743]:=",ExpressionUUID->"20f86dcc-0ccd-43c9-98c6-0be95800ba60"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.7495498866392117`*^9, 3.7495499080504723`*^9}, 
   3.749550432276535*^9, 3.749550623948358*^9, 3.749551642406583*^9, 
   3.7495518411208267`*^9},
 CellLabel->
  "Out[743]=",ExpressionUUID->"3d598ffc-dd21-4d22-868f-f5188870b568"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "3"], ",", 
     FractionBox["19", "9"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "3"], ",", 
     FractionBox["31", "9"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7495498866392117`*^9, 3.7495499080504723`*^9}, 
   3.749550432276535*^9, 3.749550623948358*^9, 3.749551642406583*^9, 
   3.7495518411373587`*^9},
 CellLabel->
  "Out[745]=",ExpressionUUID->"54b847ba-3e77-46e7-9bb1-ce761066e7f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["19", "9"], ",", 
   FractionBox["31", "9"], ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{{3.7495498866392117`*^9, 3.7495499080504723`*^9}, 
   3.749550432276535*^9, 3.749550623948358*^9, 3.749551642406583*^9, 
   3.749551841147204*^9},
 CellLabel->
  "Out[746]=",ExpressionUUID->"e6cacfbe-b06c-4d6b-9f3d-fd898ea408fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"f", " ", ":=", " ", 
    RowBox[{"InterpolatingPolynomial", "[", 
     RowBox[{"d", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Expand", "[", "f", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"diff0", "[", 
         RowBox[{"k", ",", "l"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "0", ",", "n"}], "}"}]}], "]"}], ".", "d2"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"diff0", "[", 
          RowBox[{"k", ",", "l"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "0", ",", "n"}], "}"}]}], "]"}], ".", "d2"}], " ", 
      RowBox[{"FunctionExpand", "[", 
       RowBox[{"FactorialPower", "[", 
        RowBox[{"x", ",", "k"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"g", " ", ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"diff0", "[", 
           RowBox[{"k", ",", "l"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "0", ",", "n"}], "}"}]}], "]"}], ".", "d2"}], "   ", 
       RowBox[{
        RowBox[{"FunctionExpand", "[", 
         RowBox[{"FactorialPower", "[", 
          RowBox[{
           RowBox[{"x", " ", "n"}], ",", "k"}], "]"}], "]"}], "/", " ", 
        RowBox[{"Factorial", "[", "k", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", 
        RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"h", " ", ":=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", "  ", 
           RowBox[{
            RowBox[{"diff0", "[", 
             RowBox[{"k", ",", "l"}], "]"}], "  ", ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "0", ",", "n"}], "}"}]}], "]"}], ".", "d2"}], "  ", 
         RowBox[{"n", "^", "m"}], " ", 
         RowBox[{
          RowBox[{"StirlingS1", "[", 
           RowBox[{"k", ",", "m"}], "]"}], "/", " ", 
          RowBox[{"Factorial", "[", "k", "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "h"}]}]], "Input",
 CellChangeTimes->{{3.7495460301056337`*^9, 3.749546150552847*^9}, {
   3.749546198972649*^9, 3.749546291126536*^9}, {3.749546372674322*^9, 
   3.74954643019832*^9}, {3.7495464794874153`*^9, 3.749546632030587*^9}, {
   3.749547125875698*^9, 3.749547149668849*^9}, {3.749547187292811*^9, 
   3.749547196402919*^9}, {3.74954722773913*^9, 3.749547241670442*^9}, {
   3.749547276055147*^9, 3.749547283226609*^9}, {3.749547758123528*^9, 
   3.749547766222251*^9}, {3.7495478098294*^9, 3.7495478188100147`*^9}, {
   3.749547956352969*^9, 3.749547956595916*^9}, {3.749547988196661*^9, 
   3.74954798834551*^9}, {3.7495480185581007`*^9, 3.749548042576635*^9}, {
   3.749548096767167*^9, 3.749548112824801*^9}, {3.749548148839486*^9, 
   3.7495482344396067`*^9}, {3.7495482954910297`*^9, 
   3.7495482956675787`*^9}, {3.7495483273692417`*^9, 3.749548338189639*^9}, {
   3.749548439495672*^9, 3.74954844563697*^9}, {3.749548530760906*^9, 
   3.749548567647277*^9}, {3.7495486357241163`*^9, 3.749548654373951*^9}, {
   3.7495487533697968`*^9, 3.749548753636612*^9}, {3.74954882314541*^9, 
   3.749548823531825*^9}, {3.749548879463665*^9, 3.7495489351694307`*^9}, {
   3.749549016471795*^9, 3.749549052960651*^9}, {3.749549180376073*^9, 
   3.749549265793456*^9}, {3.749549304654625*^9, 3.749549327153192*^9}, {
   3.74954938974116*^9, 3.7495494126333*^9}, {3.749549520504283*^9, 
   3.749549563248365*^9}, {3.749549621107256*^9, 3.749549732769825*^9}, 
   3.7495497651501083`*^9, {3.7495497987608023`*^9, 3.749549814983445*^9}, 
   3.749549879588828*^9, {3.749549950405966*^9, 3.7495500045867023`*^9}, {
   3.749550055610127*^9, 3.749550094068465*^9}, {3.749550156400259*^9, 
   3.749550199775516*^9}, {3.749550245363586*^9, 3.749550269140111*^9}, {
   3.7495503658506317`*^9, 3.7495504041208076`*^9}, {3.749550553536045*^9, 
   3.749550579404481*^9}, {3.749550609776881*^9, 3.749550654139421*^9}, {
   3.749550903876832*^9, 3.7495509179978333`*^9}, {3.749550969621999*^9, 
   3.749550999476605*^9}, {3.749551598852015*^9, 3.749551607648039*^9}, {
   3.7495519455726957`*^9, 3.749551946754475*^9}, {3.749552001744411*^9, 
   3.749552026239386*^9}, {3.749552101759777*^9, 3.74955210624437*^9}, {
   3.7495521455505037`*^9, 3.74955219987115*^9}},
 CellLabel->
  "In[787]:=",ExpressionUUID->"6bc55fa7-2dfb-4bf7-9b14-cda053ad9e2c"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"3", " ", "x"}], "+", 
  SuperscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{{3.749550563954669*^9, 3.7495506467251253`*^9}, 
   3.7495509214422207`*^9, 3.749551000522509*^9, 3.749551541282722*^9, 
   3.749551609843918*^9, 3.74955164700931*^9, 3.749551843300955*^9, 
   3.749551948412758*^9, 3.749552007441414*^9, 3.749552110534181*^9, {
   3.7495521776508408`*^9, 3.7495522018311872`*^9}},
 CellLabel->
  "Out[788]=",ExpressionUUID->"9f282cdd-cdfc-401b-ae07-ea81ac9e0cec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["10", "9"], ",", 
   FractionBox["2", "9"], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.749550563954669*^9, 3.7495506467251253`*^9}, 
   3.7495509214422207`*^9, 3.749551000522509*^9, 3.749551541282722*^9, 
   3.749551609843918*^9, 3.74955164700931*^9, 3.749551843300955*^9, 
   3.749551948412758*^9, 3.749552007441414*^9, 3.749552110534181*^9, {
   3.7495521776508408`*^9, 3.7495522018472433`*^9}},
 CellLabel->
  "Out[789]=",ExpressionUUID->"a2de596c-3408-43ba-9c8f-0cc6374ebc67"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox[
    RowBox[{"10", " ", "x"}], "9"], ",", 
   RowBox[{
    FractionBox["2", "9"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x"}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.749550563954669*^9, 3.7495506467251253`*^9}, 
   3.7495509214422207`*^9, 3.749551000522509*^9, 3.749551541282722*^9, 
   3.749551609843918*^9, 3.74955164700931*^9, 3.749551843300955*^9, 
   3.749551948412758*^9, 3.749552007441414*^9, 3.749552110534181*^9, {
   3.7495521776508408`*^9, 3.7495522018569736`*^9}},
 CellLabel->
  "Out[790]=",ExpressionUUID->"847ff825-85f5-48a4-9c3b-c3b0c96ec746"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"3", " ", "x"}], "+", 
  SuperscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{{3.749550563954669*^9, 3.7495506467251253`*^9}, 
   3.7495509214422207`*^9, 3.749551000522509*^9, 3.749551541282722*^9, 
   3.749551609843918*^9, 3.74955164700931*^9, 3.749551843300955*^9, 
   3.749551948412758*^9, 3.749552007441414*^9, 3.749552110534181*^9, {
   3.7495521776508408`*^9, 3.749552201866267*^9}},
 CellLabel->
  "Out[792]=",ExpressionUUID->"0a40d147-04db-4681-8dca-d53c5f91f150"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.749550563954669*^9, 3.7495506467251253`*^9}, 
   3.7495509214422207`*^9, 3.749551000522509*^9, 3.749551541282722*^9, 
   3.749551609843918*^9, 3.74955164700931*^9, 3.749551843300955*^9, 
   3.749551948412758*^9, 3.749552007441414*^9, 3.749552110534181*^9, {
   3.7495521776508408`*^9, 3.749552201874639*^9}},
 CellLabel->
  "Out[794]=",ExpressionUUID->"ab9746c4-7b5f-4c31-a400-d83aa7b5609b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"diff0", "[", 
    RowBox[{
     RowBox[{"k_Integer", "?", "NonNegative"}], ",", 
     RowBox[{"l_Integer", "?", "NonNegative"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"l", ">", "k"}], ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"l", "+", "k"}], ")"}]}], 
      RowBox[{"Binomial", "[", 
       RowBox[{"k", ",", "l"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7495461675278797`*^9, 3.7495461842077417`*^9}, 
   3.749546214629241*^9, 3.749546350080346*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"0fb566f0-ceb3-4381-aa61-13fb3dddea8f"]
},
WindowSize->{808, 905},
WindowMargins->{{272, Automatic}, {Automatic, 18}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2712, 53, 94, "Input",ExpressionUUID->"20f86dcc-0ccd-43c9-98c6-0be95800ba60"],
Cell[3295, 77, 279, 5, 34, "Output",ExpressionUUID->"3d598ffc-dd21-4d22-868f-f5188870b568"],
Cell[3577, 84, 638, 19, 51, "Output",ExpressionUUID->"54b847ba-3e77-46e7-9bb1-ce761066e7f8"],
Cell[4218, 105, 388, 9, 51, "Output",ExpressionUUID->"e6cacfbe-b06c-4d6b-9f3d-fd898ea408fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4643, 119, 5314, 120, 262, "Input",ExpressionUUID->"6bc55fa7-2dfb-4bf7-9b14-cda053ad9e2c"],
Cell[9960, 241, 523, 10, 34, "Output",ExpressionUUID->"9f282cdd-cdfc-401b-ae07-ea81ac9e0cec"],
Cell[10486, 253, 554, 11, 51, "Output",ExpressionUUID->"a2de596c-3408-43ba-9c8f-0cc6374ebc67"],
Cell[11043, 266, 690, 17, 51, "Output",ExpressionUUID->"847ff825-85f5-48a4-9c3b-c3b0c96ec746"],
Cell[11736, 285, 521, 10, 34, "Output",ExpressionUUID->"0a40d147-04db-4681-8dca-d53c5f91f150"],
Cell[12260, 297, 507, 9, 34, "Output",ExpressionUUID->"ab9746c4-7b5f-4c31-a400-d83aa7b5609b"]
}, Open  ]],
Cell[12782, 309, 740, 21, 52, "Input",ExpressionUUID->"0fb566f0-ceb3-4381-aa61-13fb3dddea8f"]
}
]
*)

